# 快速测试指南 - 自定义对话框

## 启动应用

```bash
npm start
```

## 测试项目

### ✅ 测试1: 删除课程目标
1. 在"二、课程目标"部分找到"删除课程目标"按钮
2. 点击按钮
3. **期望**: 出现美观的自定义对话框，标题"确认删除课程目标"
4. 点击"删除"或"取消"
5. **关键检查**: 对话框关闭后，点击任意输入框应该立即可以输入，无需等待

### ✅ 测试2: 删除表格行
1. 在表1（三、课程目标达成情况评价）中找到删除按钮
2. 点击删除指标或删除行按钮
3. **期望**: 出现红色"删除"按钮的确认对话框
4. 测试点击"取消"
5. **关键检查**: 立即点击表格中的任意可编辑单元格，应该可以输入

### ✅ 测试3: 删除考核方式
1. 在表2（考核方式）中找到删除最后一行按钮
2. 如果只剩一行，点击删除
3. **期望**: 出现"无法删除"提示对话框
4. 点击"确定"
5. **关键检查**: 点击表格中的输入框应该立即可用

### ✅ 测试4: 撤销操作
1. 在页面底部找到"撤销上次隐藏"按钮
2. 点击按钮
3. **期望**: 出现"确认撤销"对话框
4. 点击"取消"
5. **关键检查**: 输入框保持可用

### ✅ 测试5: 恢复全部
1. 在页面底部找到"恢复全部"按钮
2. 点击按钮
3. **期望**: 出现红色"恢复"按钮的危险操作对话框
4. 点击"取消"
5. **关键检查**: 所有输入区域应该可以正常点击和编辑

## 对比测试（可选）

如果想对比旧方案和新方案的区别：

### 启用旧方案（监听恢复）
编辑 `src/renderer/course-report.html` 第108行：
```javascript
const DEBUG_INPUT_FIX = true;  // 改为true
```

### 禁用自定义对话框
注释掉 `course-report.html` 第106行：
```html
<!-- <script src="scripts/custom-dialogs.js"></script> -->
```

并恢复所有`customConfirm`/`customAlert`为`confirm`/`alert`。

**注意**：不推荐这样做，新方案已经解决了所有问题。

## 成功标准

所有测试通过的标准：
- ✅ 对话框外观美观（圆角、阴影、动画）
- ✅ 对话框关闭后，点击输入框**立即**响应（无延迟）
- ✅ ESC键可以关闭对话框
- ✅ 点击遮罩层可以关闭对话框
- ✅ 控制台无错误信息
- ✅ 按钮颜色正确（删除操作为红色）

## 控制台测试

在开发者工具控制台（F12）执行：

```javascript
// 测试confirm
customConfirm('测试消息', '测试标题').then(result => {
    console.log('结果:', result);
});

// 测试alert
customAlert('测试提示', '提示标题').then(() => {
    console.log('对话框已关闭');
});

// 测试危险操作样式
customConfirm('危险操作', '警告', { danger: true }).then(result => {
    console.log('结果:', result);
});
```

## 故障排查

### 问题: 对话框没有出现
**检查**: 
1. 控制台是否有错误
2. custom-dialogs.js是否加载成功（Network标签）
3. 是否所有调用都使用了await

### 问题: 函数报错"await is only valid in async function"
**原因**: 函数没有声明为async
**解决**: 
```javascript
// 错误
function myFunction() {
    await customConfirm(...);
}

// 正确
async function myFunction() {
    await customConfirm(...);
}
```

### 问题: 对话框样式错误
**检查**: 
1. custom-dialogs.js中的<style>标签是否正确插入
2. 浏览器缓存（Ctrl+Shift+R强制刷新）

## 预期效果

使用新方案后：
- 🎯 **零失焦**：对话框关闭后输入框立即可用
- 🎨 **美观**：现代化的UI设计
- ⚡ **流畅**：无延迟、无闪烁
- 🔧 **可维护**：代码清晰，易于扩展

对比旧方案的改进：
- ❌ 旧方案：需要在12个时间点重复恢复，仍可能失败
- ✅ 新方案：从根本上避免失焦，无需恢复操作
