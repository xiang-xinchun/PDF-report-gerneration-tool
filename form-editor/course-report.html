<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>课程目标达成情况评价报告生成工具</title>
    <link rel="stylesheet" href="report-styles.css">
    <link rel="stylesheet" href="edit-fix.css"><!-- 添加编辑功能修复CSS -->
    <link rel="stylesheet" href="table-styles.css"><!-- 添加表格样式CSS -->
    <link rel="stylesheet" href="export-hide.css"><!-- 添加导出隐藏样式 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"><!-- 添加Bootstrap图标 -->
    <!-- 添加MathJax配置 -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            svg: {
                fontCache: 'global'
            },
            startup: {
                ready: function() {
                    MathJax.startup.defaultReady();
                    console.log('MathJax初始化完成');
                }
            }
        };
    </script>
</head>

<body>
    <div id="debug-info" style="position: fixed; bottom: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; font-size: 12px; z-index: 9999; max-width: 400px; display: none;"></div>
    
    <!-- Toast通知容器 -->
    <div class="toast-container" style="position: fixed; top: 60px; right: 10px; z-index: 9999;">
      <div id="notification-toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true" style="background-color: white; border-radius: 4px; box-shadow: 0 2px 10px rgba(0,0,0,0.2);">
        <div class="toast-header" style="padding: 8px 12px; border-bottom: 1px solid #eee;">
          <strong id="toast-title" style="margin-right: auto;">通知</strong>
          <button type="button" class="btn-close" style="background: none; border: none; font-size: 16px; cursor: pointer;" onclick="this.closest('.toast').style.display='none';">&times;</button>
        </div>
        <div id="toast-message" class="toast-body" style="padding: 10px 12px;">
          消息内容
        </div>
      </div>
    </div>
    
    <!-- 操作按钮 -->
    <div class="edit-controls" style="position: fixed; top: 10px; right: 10px; z-index: 9999;">
        <button id="reset-button" class="reset-button" title="恢复所有内容到初始状态" onclick="resetAllContent()"><i class="bi bi-arrow-repeat"></i> 恢复全部</button>
        <button id="undo-button" class="undo-button" title="撤销上一次删除操作" onclick="undoLastOperation()" disabled><i class="bi bi-arrow-counterclockwise"></i> 撤销</button>
    </div>
    <div class="report-container" id="reportContent">
        <div class="step active" id="step1">
            <header>
                <img src="./school_badge.png" alt="江西师范大学" class="school-logo">
                <h1><span class="title-wrapper">《<span contenteditable="true" class="input-def" id="courseName" data-placeholder="请填写课程名称"></span>》</span>课程目标达成情况评价报告</h1>
            </header>

            <h2>一、课程简介</h2>
            <div class="input-field" id="courseSubject" contenteditable="true" rows="1"></div>
            <h2>二、课程目标</h2>
            <p class="paragraph">通过本课程的教学，学生应该具备如下知识和能力：</p>
            <div class="paragraph" id="target1-container">目标1：
                <div contenteditable="true" class="editable-text" id="target1" data-placeholder="请填写目标1"></div>
                <button class="delete-button" title="删除此项" onclick="hideEditableItem('target1-container')">×</button>
            </div>
            <div class="paragraph" id="target2-container">目标2：
                <div contenteditable="true" class="editable-text" id="target2" data-placeholder="请填写目标2"></div>
                <button class="delete-button" title="删除此项" onclick="hideEditableItem('target2-container')">×</button>
            </div>
            <div class="paragraph" id="target3-container">目标3：
                <div contenteditable="true" class="editable-text" id="target3" data-placeholder="请填写目标3"></div>
                <button class="delete-button" title="删除此项" onclick="hideEditableItem('target3-container')">×</button>
            </div>
            <div class="paragraph" id="target4-container">目标4：
                <div contenteditable="true" class="editable-text" id="target4" data-placeholder="请填写目标4"></div>
                <button class="delete-button" title="删除此项" onclick="hideEditableItem('target4-container')">×</button>
            </div>

            <h2>三、课程目标对毕业要求指标点的支撑关系</h2>
            <p class="paragraph">表1是依据江西师范大学材料化学专业人才培养方案和《
                <span id="courseNameShow1"></span>
                》课程大纲得到的课程目标对毕业要求各指标点的对应支撑关系矩阵。
            </p>
            <div style="font-size: 12px;" class="table-name">表1.课程目标对毕业要求指标点的支撑矩阵</div>
            <div class="table-container">
                <table>
                    <thead class="table-header">
                        <tr>
                            <th class="table-th" colspan="2"></th>
                            <th class="table-th">课程目标1</th>
                            <th class="table-th">课程目标2</th>
                            <th class="table-th">课程目标3</th>
                            <th class="table-th">课程目标4</th>
                            <th class="table-th delete-cell">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="table-row-1">
                            <td class="table-td category" rowspan="1">师德规范</td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('table-row-1')">×</button></td>
                        </tr>
                        <tr id="table-row-2">
                            <td class="table-td category" rowspan="1">教育情怀</td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('table-row-2')">×</button></td>
                        </tr>
                        <tr id="table-row-3">
                            <td class="table-td category" rowspan="2">学科素养</td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('table-row-3')">×</button></td>
                        </tr>
                        <tr id="table-row-4">
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('table-row-4')">×</button></td>
                        </tr>
                        <tr id="table-row-5">
                            <td class="table-td category" rowspan="1">教学能力</td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('table-row-5')">×</button></td>
                        </tr>
                        <tr id="table-row-6">
                            <td class="table-td category" rowspan="1">班级指导</td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('table-row-6')">×</button></td>
                        </tr>
                        <tr id="table-row-7">
                            <td class="table-td category" rowspan="1">综合育人</td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('table-row-7')">×</button></td>
                        </tr>
                        <tr id="table-row-8">
                            <td class="table-td category" rowspan="1">学会反思</td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('table-row-8')">×</button></td>
                        </tr>
                        <tr id="table-row-9">
                            <td class="table-td category" rowspan="1">沟通合作</td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td"><div contenteditable="true" class="input-field"></div></td>
                            <td class="table-td delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('table-row-9')">×</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p style="font-size: 12px;">注："H"表示高关联度，"M"表示中等关联度，"L"表示低关联度。</p>
        </div>

        <div class="step" id="step2">
            <h2>四、课程目标与考核方式的对应权重关系</h2>
            <div class="paragraph">本课程目标达成度评价采用直接评价方式进行。直接评价采用"考试成绩分析法"，数据源自抽取样本学生的课程考核成绩，对应的支撑材料为
                <div contenteditable="true" class="input-def" id="supportMaterial" data-placeholder="请填写支撑材料"></div>
                等成绩，其对应的各个课程目标考核方式与权重关系见下表2。
            </div>            
            <p style="font-size: 12px;" class="table-name">表2.课程考核方式对课程目标的权重关系矩阵</p>
            <div class="table-container">
                <table>
                    <thead class="table-header">
                        <tr>
                            <th rowspan="2">考核方式</th>
                            <th rowspan="2">满分</th>
                            <th colspan="4">权重</th>
                            <th rowspan="2" class="delete-cell">操作</th>
                        </tr>
                        <tr>
                            <th>课程目标1</th>
                            <th>课程目标2</th>
                            <th>课程目标3</th>
                            <th>课程目标4</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="exam-row-1">
                            <td>课堂表现</td>
                            <td><div contenteditable="true" class="input-field" id="score1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight1-1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight1-2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight1-3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight1-4"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('exam-row-1')">×</button></td>
                        </tr>
                        <tr id="exam-row-2">
                            <td>课后作业</td>
                            <td><div contenteditable="true" class="input-field" id="score2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight2-1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight2-2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight2-3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight2-4"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('exam-row-2')">×</button></td>
                        </tr>
                        <tr id="exam-row-3">
                            <td>线上作业</td>
                            <td><div contenteditable="true" class="input-field" id="score3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight3-1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight3-2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight3-3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight3-4"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('exam-row-3')">×</button></td>
                        </tr>
                        <tr id="exam-row-4">
                            <td>期末考试</td>
                            <td><div contenteditable="true" class="input-field" id="score4"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight4-1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight4-2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight4-3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="weight4-4"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('exam-row-4')">×</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <h2>五、课程目标达成度评价</h2>
            <h3>（一）课程分目标的权重值</h3>
            <p class="paragraph">《<span id="courseNameShow2"></span>》
                课程中有4个课程目标，设本课程有n个课程分目标，
                第i个课程分目标对应8个毕业要求分解指标点的支撑强度值为Vi
                （第i个课程分目标对8个毕业要求分解指标点的支撑强度分别有x个H、y个M、z个L，
                按照赋值H=3、M=2、L=1计算，则第i个课程分目标的支撑强度值Vi=3x+2y+1z），
                则第i个课程目标的权重值(wi)计算公式为：
            </p>
            <div class="formula">
                <p class="formula-content">w_i = V_i / \sum V_i (i=1,2,3,...n)</p>
                <p class="formula-name">公式（1）</p>
            </div>
            <div class="paragraph">通过累加可以计算出单个课程目标对应的权值，以及总权值为
                <div contenteditable="true" class="input-def" id="totalWeight" data-placeholder="此处生成总权值"></div>。
                《<span id="courseNameShow3"></span>》课程4个分目标对应的权重值计算如下：
            </div>
            
            <p class="table-name">表3.课程目标的权重值</p>
            <div class="table-container">
                <table>
                    <thead class="table-header">
                        <tr>
                            <th></th>
                            <th>课程目标1</th>
                            <th>课程目标2</th>
                            <th>课程目标3</th>
                            <th>课程目标4</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="weight-value-row">
                            <td>权重值</td>
                            <td><div contenteditable="true" class="input-field" id="targetWeight1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="targetWeight2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="targetWeight3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="targetWeight4"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('weight-value-row')">×</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="step" id="step3">
            <h3>（二）课程分目标的达成度</h3>
            <p class="paragraph">根据表2中各个课程分目标与考核方式权重的对应关系，
                设各种考核方式的权重、考核总分和考核平均分的数值分别为Kij、Zij、Qij
                （i=1,2,3,...n；j为考核方式的项数），则本课程分目标i的评价达成度Pi为：
            </p>
            <div class="formula">
                <p class="formula-content">P_i = \sum (K_{ij} \times Q_{ij} / Z_{ij})</p>
                <p class="formula-name">公式（2）</p>
            </div>
            <p class="table-name">表4.课程考核方式对应的考核成绩情况</p>
            <div class="table-container">
                <table>
                    <thead class="table-header">
                        <tr>
                            <th></th>
                            <th>课堂表现</th>
                            <th>课后作业</th>
                            <th>线上作业</th>
                            <th>期末考试</th>
                            <th class="delete-cell">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="score-row-1">
                            <td>总分</td>
                            <td><div contenteditable="true" class="input-field" id="totalScore1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="totalScore2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="totalScore3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="totalScore4"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('score-row-1')">×</button></td>
                        </tr>
                        <tr id="score-row-2">
                            <td>平均分</td>
                            <td><div contenteditable="true" class="input-field" id="avgScore1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="avgScore2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="avgScore3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="avgScore4"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('score-row-2')">×</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <p class="table-name">表5：课程分目标达成度</p>
            <div class="table-container">
                <table>
                    <thead class="table-header">
                        <tr>
                            <th></th>
                            <th>课程目标1</th>
                            <th>课程目标2</th>
                            <th>课程目标3</th>
                            <th>课程目标4</th>
                            <th class="delete-cell">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="achievement-row">
                            <td>课程分目标的达成度</td>
                            <td><div contenteditable="true" class="input-field" id="targetAchieve1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="targetAchieve2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="targetAchieve3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="targetAchieve4"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('achievement-row')">×</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <h3>（三）课程目标的总达成度</h3>
            <p class="paragraph">课程的整体目标达成度由该课程所有的课程分目标达成度的加权平均值确定。
               设本课程有n个课程目标，利用公式(1)计算得到的第i课程目标的权重值为wi，
               利用公式(2)计算得到的第i个课程分目标的达成度为Pi，则该门课程的整体目标达成度P为：
            </p>
            <div class="formula">
                <p class="formula-content">P = \sum (w_i \times P_i)</p>
                <p class="formula-name">公式（3）</p>
            </div>
            <p class="paragraph">根据公式（3），计算可得《<span id="courseNameShow4"></span>》课程目标总达成度为：</p>
            <div class="table-container">
                <table>
                    <thead class="table-header">
                        <tr>
                            <th></th>
                            <th>权重值</th>
                            <th>课程分目标达成度</th>
                            <th>课程目标总达成度</th>
                            <th class="delete-cell">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="goal-row-1">
                            <td>课程目标1</td>
                            <td><div contenteditable="true" class="input-field" id="showWeight1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="showAchieve1"></div></td>
                            <td rowspan="4"><input type="text" id="totalAchieve" class="input-field"></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('goal-row-1')">×</button></td>
                        </tr>
                        <tr id="goal-row-2">
                            <td>课程目标2</td>
                            <td><div contenteditable="true" class="input-field" id="showWeight2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="showAchieve2"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('goal-row-2')">×</button></td>
                        </tr>
                        <tr id="goal-row-3">
                            <td>课程目标3</td>
                            <td><div contenteditable="true" class="input-field" id="showWeight3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="showAchieve3"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('goal-row-3')">×</button></td>
                        </tr>
                        <tr id="goal-row-4">
                            <td>课程目标4</td>
                            <td><div contenteditable="true" class="input-field" id="showWeight4"></div></td>
                            <td><div contenteditable="true" class="input-field" id="showAchieve4"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('goal-row-4')">×</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <h2>六、课程目标达成情况评价分析与持续改进</h2>
            
            <div class="table-container">
                <table>
                    <tbody>
                        <tr id="course-info-row-1">
                            <td><strong>课程名称</strong></td>
                            <td><span id="courseNameShow5"></span></td>
                            <td><strong>课程类别</strong></td>
                            <td><div contenteditable="true" class="input-field"></div></td>
                            <td><strong>学时</strong></td>
                            <td><div contenteditable="true" class="input-field"></div></td>
                            <td><strong>学分</strong></td>
                            <td><div contenteditable="true" class="input-field"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('course-info-row-1')">×</button></td>
                        </tr>
                        <tr id="course-info-row-2">
                            <td><strong>任课教师</strong></td>
                            <td><div contenteditable="true" class="input-field" id="teacherName"></div></td>
                            <td><strong>教师职称</strong></td>
                            <td><div contenteditable="true" class="input-field" id="teacherTitle"></div></td>
                            <td colspan="2"><strong>授课时间</strong></td>
                            <td colspan="2"><div contenteditable="true" class="input-field" id="teachTime"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('course-info-row-2')">×</button></td>
                        </tr>
                        <tr id="course-info-row-3">
                            <td><strong>授课班级</strong></td>
                            <td><div contenteditable="true" class="input-field" id="className"></div></td>
                            <td><strong>学生人数</strong></td>
                            <td><div contenteditable="true" class="input-field" id="studentCount"></div></td>
                            <td colspan="2"><strong>期末考核方式</strong></td>
                            <td colspan="2"><div contenteditable="true" class="input-field" id="examMethod"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('course-info-row-3')">×</button></td>
                        </tr>
                        <tr id="grade-analysis-row-1">
                            <td colspan="2" rowspan="4"><strong>成绩分析</strong></td>
                            <td><strong>最高分</strong></td>
                            <td><div contenteditable="true" class="input-field" id="maxScore"></div></td>
                            <td><strong>最低分</strong></td>
                            <td><div contenteditable="true" class="input-field" id="minScore"></div></td>
                            <td><strong>平均分</strong></td>
                            <td><div contenteditable="true" class="input-field" id="avgTotalScore"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('grade-analysis-row-1')">×</button></td>
                        </tr>
                        <tr id="grade-analysis-row-2">
                            <td><strong>分数</strong></td>
                            <td>100-90</td>
                            <td>89-80</td>
                            <td>79-70</td>
                            <td>69-60</td>
                            <td>60分以下</td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('grade-analysis-row-2')">×</button></td>
                        </tr>
                        <tr id="grade-analysis-row-3">
                            <td><strong>人数</strong></td>
                            <td><div contenteditable="true" class="input-field" id="count1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="count2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="count3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="count4"></div></td>
                            <td><div contenteditable="true" class="input-field" id="count5"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('grade-analysis-row-3')">×</button></td>
                        </tr>
                        <tr id="grade-analysis-row-4">
                            <td><strong>百分比</strong></td>
                            <td><div contenteditable="true" class="input-field" id="rate1"></div></td>
                            <td><div contenteditable="true" class="input-field" id="rate2"></div></td>
                            <td><div contenteditable="true" class="input-field" id="rate3"></div></td>
                            <td><div contenteditable="true" class="input-field" id="rate4"></div></td>
                            <td><div contenteditable="true" class="input-field" id="rate5"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('grade-analysis-row-4')">×</button></td>
                        </tr>
                        <tr id="course-goal-row">
                            <td colspan="2"><strong>课程目标达成情况分析</strong><br></td>
                            <td colspan="6"><div contenteditable="true" class="input-field" id="rate6"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('course-goal-row')">×</button></td>
                        </tr>
                        <tr id="continuous-improvement-row">
                            <td colspan="2"><strong>持续改进措施</strong><br></td>
                            <td colspan="6"><div contenteditable="true" class="input-field" id="rate7"></div></td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('continuous-improvement-row')">×</button></td>
                        </tr>
                        <tr id="department-leader-row">
                            <td colspan="2"><strong>教研室主任或系主任意见</strong></td>
                            <td colspan="6" class="signature-cell">
                                <div class="signature-group">
                                    <div class="signature-item">
                                        <span class="signature-label">教研室主任或系主任签名：</span>
                                    </div>
                                    <div class="signature-item">
                                        <span class="signature-label">日期：</span>
                                    </div>
                                </div>
                            </td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('department-leader-row')">×</button></td>
                        </tr>
                        <tr id="college-approval-row">
                            <td colspan="2"><strong>学院审核意见</strong></td>
                            <td colspan="6" class="signature-cell">
                                <div class="signature-group">
                                    <div class="signature-item">
                                        <span class="signature-label">学院负责人签名：</span>
                                    </div>
                                    <div class="signature-item">
                                        <span class="signature-label">日期：</span>
                                    </div>
                                </div>
                            </td>
                            <td class="delete-cell"><button class="row-delete-button" title="删除此行" onclick="hideTableRow('college-approval-row')">×</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
        </div>
        </div>
        <!-- 步骤导航 - 只在编辑时可见 -->
        <div class="step-nav no-print">
            <button id="prevBtn" disabled>上一步</button>
            <button id="nextBtn">下一步</button>
        </div>
    </div>

    <!-- 操作按钮 - 只在编辑时可见 -->
    <div class="action-buttons no-print">
        <button id="exportBtn" class="action-button">导出PDF报告</button>
    </div>

    <!-- 调试信息区域 -->
    <div id="debug-info" style="display: none; position: fixed; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.8); color: white; padding: 5px; font-size: 12px;">
        <div>调试信息：<span id="debug-message">无消息</span></div>
        <button onclick="document.getElementById('debug-info').style.display = 'none'">关闭</button>
    </div>

    <script>
        // 全局调试函数
        window.showDebug = function(msg) {
            const debugInfo = document.getElementById('debug-info');
            const debugMsg = document.getElementById('debug-message');
            if (debugInfo && debugMsg) {
                debugMsg.textContent = msg;
                debugInfo.style.display = 'block';
            }
            console.log('[DEBUG]', msg);
        };
    </script>

    <!-- 页面脚本在外部JS文件中加载 -->
    <script src="report-editor.js"></script>
</body>

</html>