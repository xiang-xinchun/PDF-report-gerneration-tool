# 便携版说明 - Windows 7 最佳方案

## 🎯 为什么推荐便携版？

对于 Windows 7 用户，**便携版是最佳选择**，因为：

### ✅ 优势
- **零依赖** - 不需要 .NET Framework
- **即开即用** - 双击即可运行，无需安装
- **无权限要求** - 不需要管理员权限
- **完全便携** - 可在U盘运行，数据随身带
- **不写注册表** - 不污染系统
- **易于卸载** - 直接删除文件夹即可

### ⚠️ 唯一要求
- **Visual C++ Redistributable 2015-2022**
- 大多数 Windows 7 系统已经安装
- 如未安装，仅需安装一次（8MB左右）

---

## 📦 三种打包格式对比

| 特性 | Setup.exe<br>(安装程序) | Portable.exe<br>(便携版) | .zip<br>(压缩包) |
|------|------------------------|------------------------|-----------------|
| 需要 .NET Framework | ✅ 必需 | ❌ 不需要 | ❌ 不需要 |
| 需要安装 | ✅ 是 | ❌ 否 | ❌ 否 |
| 双击运行 | ❌ | ✅ | ✅ (解压后) |
| U盘运行 | ❌ | ✅ | ✅ |
| 管理员权限 | 可选 | ❌ 不需要 | ❌ 不需要 |
| 创建快捷方式 | ✅ 自动 | ❌ 手动 | ❌ 手动 |
| 文件大小 | ~120MB | ~120MB | ~115MB |
| **Win7推荐度** | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

---

## 🚀 便携版使用方法

### Windows 7 用户（推荐流程）

#### 步骤1: 下载
```
课程目标达成情况评价报告生成工具-1.0.0-x64-Portable.exe
```
或
```
课程目标达成情况评价报告生成工具-1.0.0-x64.zip
```

#### 步骤2: 放置文件
- **Portable.exe**: 放到任意文件夹，如 `D:\应用程序\`
- **.zip**: 解压到任意文件夹，如 `D:\应用程序\课程报告工具\`

#### 步骤3: 运行
- 双击 `.exe` 文件

#### 步骤4: 如果提示缺少DLL
下载并安装 Visual C++ Redistributable:
- **64位系统**: https://aka.ms/vs/17/release/vc_redist.x64.exe
- **32位系统**: https://aka.ms/vs/17/release/vc_redist.x86.exe

#### 步骤5: 创建快捷方式（可选）
- 右键 `.exe` → 发送到 → 桌面快捷方式
- 或 右键 → 创建快捷方式 → 拖到桌面

---

## 📂 便携版文件结构

```
课程目标达成情况评价报告生成工具-1.0.0-x64-Portable.exe  (约120MB)
```

运行后会创建：
```
%APPDATA%\course-report-generator\
├── Cache\              # 缓存文件
├── Logs\               # 日志文件
├── User Data\          # 用户数据
└── ...
```

### 完全便携模式（高级）

如果想让配置也保存在程序目录（真正的便携）：

1. 在 `.exe` 同目录创建文件 `portable.txt`
2. 配置会保存在 `.exe` 旁边的 `data` 文件夹

---

## 🆚 Portable.exe vs .zip

### Portable.exe
- **优点**: 单文件，直接运行
- **缺点**: 文件较大（120MB）
- **适合**: 需要单文件便携，或U盘运行

### .zip
- **优点**: 压缩包，可查看内部文件
- **缺点**: 需要先解压
- **适合**: 需要查看文件结构，或分发到多台电脑

**功能完全相同，选择任一即可。**

---

## 💡 部署建议

### 场景1: 单台电脑使用
```
推荐: Portable.exe
放置: C:\Users\用户名\应用程序\
```

### 场景2: U盘便携使用
```
推荐: Portable.exe + portable.txt
放置: U盘:\课程报告工具\
配置: 创建 portable.txt 使数据也保存在U盘
```

### 场景3: 多台电脑部署
```
推荐: .zip
方式: 解压到每台电脑的相同路径
好处: 便于统一管理和更新
```

### 场景4: 公用电脑（网吧、机房）
```
推荐: .zip
放置: D:\应用程序\课程报告工具\
配置: 只读模式，每次启动重置
```

---

## 🔧 高级配置

### 启用真正的便携模式

1. 在 `Portable.exe` 同目录创建 `portable.txt` (空文件)
2. 运行程序
3. 所有数据会保存在 `.\data\` 目录

**目录结构**:
```
D:\应用程序\
├── 课程目标达成情况评价报告生成工具-1.0.0-x64-Portable.exe
├── portable.txt              ← 创建此文件
└── data\                     ← 自动创建，保存所有数据
    ├── Cache\
    ├── Logs\
    └── User Data\
```

### 命令行参数

```bash
# 指定数据目录
Portable.exe --user-data-dir="D:\MyData"

# 调试模式
Portable.exe --enable-logging

# 禁用GPU加速（解决某些显示问题）
Portable.exe --disable-gpu
```

---

## ❓ 常见问题

### Q: 便携版和安装版功能有区别吗？
**A**: 完全相同，只是运行方式不同。

### Q: 便携版需要.NET Framework吗？
**A**: **不需要**！这是便携版的最大优势。

### Q: 可以同时运行多个实例吗？
**A**: 不建议。但可以通过 `--user-data-dir` 参数指定不同数据目录。

### Q: 便携版会写注册表吗？
**A**: 不会。所有数据保存在用户目录或 `data` 目录。

### Q: 如何更新便携版？
**A**: 下载新版本，替换旧的 `.exe` 文件即可。数据不会丢失。

### Q: 便携版如何卸载？
**A**: 
1. 删除 `.exe` 文件
2. 删除 `%APPDATA%\course-report-generator` 目录（如有）
3. 删除 `data` 目录（如使用便携模式）

### Q: 为什么文件这么大（120MB）？
**A**: 包含完整的 Chromium 浏览器引擎和 Node.js 运行时。这是 Electron 应用的正常大小。

### Q: 便携版启动速度慢吗？
**A**: 首次启动较慢（5-10秒），后续启动正常（2-3秒）。

### Q: 可以改名吗？
**A**: 可以。不影响功能。

---

## 🎯 推荐方案总结

| 用户类型 | 推荐版本 | 原因 |
|---------|---------|------|
| **Windows 7 用户** | **Portable.exe** | 不需要.NET Framework |
| Windows 10/11 用户 | Setup.exe 或 Portable.exe | 都可以 |
| U盘运行 | **Portable.exe** + portable.txt | 真正便携 |
| 多台电脑 | **.zip** | 便于分发 |
| 网络受限环境 | **.zip** | 离线安装 |

---

## 📞 技术支持

遇到问题？提供以下信息：
1. Windows版本（开始菜单 → 运行 → `winver`）
2. 使用版本（Portable / zip / Setup）
3. 错误截图
4. 是否安装了 VC++ Redistributable

---

## 📝 更新日志

### v1.0.0 (2026-01-31)
- ✅ 提供便携版本
- ✅ 不需要 .NET Framework
- ✅ 支持 Windows 7 SP1+
- ✅ 同时提供 64位 和 32位 版本
- ✅ 支持真正的便携模式（portable.txt）
